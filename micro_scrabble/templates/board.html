{% extends "base.html" %}
{% block title %}Scrabble | Board{% endblock %}

{% block head %}
  {{ super() }}
  {% block scripts %}
    {{ super() }}
    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="http://www.d3plus.org/js/d3plus.js"></script>
  {% endblock %}
{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-md-1">
    </div>
    <div class="col-md-10" id='grid'>
      <!-- <section id='grid'></section> -->
    </div>
    <div class="col-md-1">
    </div>
  </div>
</div>
  <script type="text/javascript" charset="utf-8">
    //create javascript object from python dictionary
    //var board_matrix = {{ board_matrix }}

    // create the svg
    var svg = d3.select('#grid').append('svg')
      .attr({
        width: {{ width }},
        height: {{ height }}
      });

    // calculate number of rows and columns
    var squaresRow = Math.round({{ width }}/ {{ square }});
    var squaresColumn = Math.round({{ height }} / {{ square }});

    var rectangles = svg.selectAll('g')
                                .data({{ board_matrix|tojson }})
                                .enter()
                                .append('g');

    var rectangle_attrs = rectangles.append('rect')
                          .attr("width",{{ square }})
                          .attr("height",{{ square }})
                          .attr("x",function(d){return d.x*{{ square }};})
                          .attr("y",function(d){return d.y*{{ square }};})
                          .attr("fill",function(d){return d.color;})
                          .attr("stroke",'#fff');

    var board_labels = rectangles.append('text')
              .text(function(d){
                if(d.letter==null){
                  return d.label;}
                else{
                  return d.letter;}
                })
              .attr("x",function(d){return d.x*{{ square }}+{{ square }}/2;})
              .attr("y",function(d){return d.y*{{ square }};})
              .attr("font-family","helvetica")
              .attr("font-size",function(d){if(d.letter){return "25px";}else{return "15px";}})
              .attr("font-weight",function(d){if(d.letter){return "bold";}else{return "normal";}})
              .attr("dy", "1.25em")
              .attr("text-anchor","middle");

    //d3plus.textwrap().container(board_labels).resize(true).draw()
  </script>
{% endblock %}
